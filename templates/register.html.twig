{% extends "master.html.twig"%}
{% block title %}Registration
{% endblock %}

{% block addHead %}
{% include 'address-js.html.twig' with {apiKey, addressType: "address"} %}
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script>
        $(document).ready(function () {
            $('input[name=email]').keyup(function() {
                var newemail = $(this).val();
                newemail = encodeURIComponent(newemail);
                $("#emailIsTaken").load('/isemailtaken/{{newemail}}' + newemail);
            });
        });
    </script>
{% endblock %}

{% block content %}

{% if errorList %}
	<ul>
		{% for error in errorList %}
			<li>{{error}}
			{% endfor %}
		</ul>
	{% endif %}

<div class="container mt-3">
	<form class="" method="post" enctype="multipart/form-data">
		<h1>Registration</h1>
		<div class="mb-3 mt-3">
        <label for="name" class="form-label">Name:</label>
		<input type="text" class="form-control" name="name" placeholder="Enter your name " id="name" value="{{ v.name }}"><br>
		</div>
		<div class="mb-3">
		<label for="username" class="form-label">Username:</label>
		<input type="text" class="form-control" name="userName" placeholder="Enter your username" value="{{v.userName}}"><br>
		</div>
		<div class="mb-3">
		<label for="email" class="form-label">Email:</label>
		<input type="text" class="form-control" name="email" placeholder="Enter your email" value="{{v.email}}"><br>
		<span id="emailIsTaken" class="errorMessage"></span>
		</div>
		<div class="mb-3">
		<label for="password" class="form-label">Password:</label>
		<br><input type="password" class="form-control" name="pass1" placeholder="Enter your password" value="{{v.pass1}}"><br>
		</div>
		<div class="mb-3">
		<label for="password" class="form-label">Password (repeated):</label>
		<input type="password" class="form-control" name="pass2"  placeholder="Enter your password again" value="{{v.pass2}}"><br><br>
        {% include "address-form.html.twig" with {
			address: v.street, 
			appartmentNo: v.appartmentNo, 
			postalCode: v.postalCode, 
			city: v.city, 
			province: v.province
			} %}
        Business Owner:
        <select required name="accountType">
            <option value="" disabled selected hidden> Choose an option</option>  
            <option name="accountType" value="customer"{% if accountType == 'customer' %} selected="selected"{% endif %}>NO</option>
            <option name="accountType" value="business"{% if accountType == 'business' %} selected="selected"{% endif %}>YES</option> 
        </select>

		<div class="mb-3">
			<label for="phone" class="form-label">Phone: </label>
			<input type="text" class="form-control" name="phone" value="{{ v.phone }}">
		</div>
		<input class="btn btn-danger"  type="submit" name="submit" value="Register">
	</form>
</div>
{% endblock content%}
